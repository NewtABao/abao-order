<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>æ—©é¤åº—è‡ªåŠ©é»é¤</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      margin: 0;
      /* é ç•™åº•éƒ¨å›ºå®šå€åŸŸçš„é«˜åº¦ */
      padding: 12px 12px 120px;
      background: #f8f1e7; /* æ•´é«”ç±³è‰²ç³»èƒŒæ™¯ */
      font-size: 16px;
    }
    h1 {
      font-size: 22px;
      text-align: center;
      margin: 8px 0 4px;
    }
    .subtitle {
      font-size: 13px;
      text-align: center;
      color: #775f4a;
      margin-bottom: 8px;
    }
    .section {
      max-width: 520px;
      margin: 0 auto 12px;
      background: #fffaf3; /* å¡ç‰‡åç™½ç±³è‰² */
      border-radius: 10px;
      padding: 10px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.06);
    }
    details {
      border-bottom: 1px solid #ecd8b8;
      padding: 4px 0;
    }
    details:last-child {
      border-bottom: none;
    }
    summary {
      list-style: none;
      cursor: pointer;
      font-size: 18px;
      font-weight: 700;
      padding: 8px 10px;
      margin: 4px 0;
      display: flex;
      align-items: center;
      justify-content: space-between;
      background: #f2d7a6; /* å¤§é¡è¼ƒæ·±ç±³è‰² */
      border-radius: 8px;
      color: #5b4126;
    }
    summary::-webkit-details-marker {
      display: none;
    }
    .summary-label {
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }
    .summary-icon {
      font-size: 14px;
      opacity: 0.7;
    }
    .cat-content {
      background: #fff3dd; /* å±•é–‹å…§å®¹è¼ƒæ·ºç±³è‰² */
      border-radius: 8px;
      margin-top: 4px;
      padding: 4px 8px 0;
    }
    .item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 8px 0;
    }
    .item + .item {
      border-top: 1px dashed #e2caa4;
    }
    .item-info {
      max-width: 60%;
    }
    .item-name {
      font-size: 15px;
      font-weight: 500;
      color: #4a3520;
    }
    .item-meta {
      font-size: 13px;
      color: #7a6755;
      margin-top: 2px;
    }
    .qty-control {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .btn-qty {
      width: 34px;
      height: 34px;
      border-radius: 50%;
      border: 1px solid #c59b6c;
      background: #fffaf3;
      font-size: 20px;
      line-height: 0;
      cursor: pointer;
      color: #704321;
    }
    .btn-qty:active {
      transform: scale(0.95);
      background: #f5e2c4;
    }
    .qty {
      min-width: 24px;
      text-align: center;
      font-size: 15px;
      color: #4a3520;
    }

    /* åº•éƒ¨å›ºå®šçš„ç¸½é‡‘é¡ + ç¢ºèªæŒ‰éˆ• */
    .footer {
      position: fixed;
      left: 0;
      right: 0;
      bottom: 0;
      background: #f6deaf; /* ç±³è‰²åº•éƒ¨åˆ— */
      box-shadow: 0 -2px 8px rgba(0,0,0,0.12);
      padding: 10px 12px calc(12px + env(safe-area-inset-bottom));
      z-index: 100;
    }
    .footer-inner {
      max-width: 520px;
      margin: 0 auto;
    }
    .total {
      display: flex;
      justify-content: space-between;
      margin-bottom: 8px;
      font-size: 16px;
      font-weight: 600;
      color: #4a3520;
    }
    .btn-primary {
      width: 100%;
      padding: 12px;
      font-size: 16px;
      border-radius: 8px;
      border: none;
      background: #c86f30; /* æ©˜æ£•è‰² */
      color: #fff;
      cursor: pointer;
    }
    .btn-primary:disabled {
      background: #d8b897;
      cursor: not-allowed;
    }
    .hint {
      font-size: 11px;
      color: #7a6755;
      text-align: center;
      margin-top: 4px;
    }

    /* ç¢ºèªç•«é¢ */
    #confirm-view {
      display: none;
      max-width: 520px;
      margin: 0 auto 12px;
      background: #fffaf3;
      border-radius: 10px;
      padding: 12px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.06);
    }
    .order-title {
      font-size: 20px;
      font-weight: 700;
      text-align: center;
      margin-bottom: 6px;
      color: #4a3520;
    }
    .order-subtitle {
      font-size: 12px;
      text-align: center;
      color: #7a6755;
      margin-bottom: 6px;
    }
    .order-total {
      margin-top: 8px;
      padding-top: 8px;
      border-top: 1px solid #4a3520;
      text-align: right;
      font-size: 18px;
      font-weight: 700;
      color: #4a3520;
    }
    .order-note {
      font-size: 11px;
      color: #7a6755;
      margin-top: 6px;
      text-align: center;
    }
    .order-back {
      margin-top: 10px;
      text-align: center;
    }
    .btn-ghost {
      border: none;
      background: transparent;
      font-size: 14px;
      text-decoration: underline;
      color: #c86f30;
      cursor: pointer;
    }

    /* å‡ºå–®ç•«é¢ï¼šä¸‰æ¬„å°é½Š */
    .order-item-row {
      display: flex;
      padding: 4px 0;
      border-bottom: 1px dashed #dbc2a2;
      font-size: 15px;
      font-family: monospace;
      color: #4a3520;
    }
    .col-name {
      width: 45%;
      text-align: left;
    }
    .col-codeqty {
      width: 25%;
      text-align: center;
      font-weight: 600;
    }
    .col-price {
      width: 30%;
      text-align: right;
      font-weight: 700;
    }

    /* åº•éƒ¨ä¸Šæ–¹ã€Œå·²é¸å“é …ã€æŠ½å±œï¼ˆæ–¹æ¡ˆ Bï¼‰ */
    .preview-drawer {
        position: fixed;
        left: 0;
        right: 0;
        bottom: 130px; /* å¾€ä¸ŠæŠ¬é«˜ï¼Œé¿å…è¢«ç¸½é‡‘é¡è“‹ä½ */
        z-index: 95;
    }
    
    .preview-drawer-inner {
      max-width: 520px;
      margin: 0 auto;
    }
    .preview-toggle {
      width: 100%;
      border-radius: 10px 10px 0 0;
      border: none;
      background: #f5e1b8; /* æ·ºç±³è‰² */
      padding: 6px 10px;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 8px;
      font-size: 13px;
      cursor: pointer;
      box-shadow: 0 -1px 4px rgba(0,0,0,0.1);
      color: #5b4126;
    }
    .preview-handle {
      font-size: 16px;
      line-height: 1;
    }
    .preview-toggle-text {
      font-weight: 600;
    }
    .preview-content {
      background: #fffaf3;
      max-height: 70vh; /* å±•é–‹ç´„ 70% è¢å¹•é«˜ */
      overflow-y: auto;
      border-radius: 0 0 10px 10px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.12);
      padding: 6px 10px 8px;
      font-size: 14px;
    }
    .preview-title {
      font-size: 14px;
      font-weight: 700;
      margin-bottom: 4px;
      color: #4a3520;
    }
    .preview-list {
      border-top: 1px dashed #e2caa4;
      margin-top: 4px;
      padding-top: 4px;
    }
    .preview-row {
      display: flex;
      align-items: center;
      font-size: 14px;
      padding: 4px 0;
      border-bottom: 1px dashed #f0e0c3;
      color: #4a3520;
    }
    .preview-name {
      flex: 1 1 55%;
      padding-right: 4px;
    }
    .preview-qty {
      flex: 0 0 20%;
      text-align: center;
      font-weight: 600;
    }
    .preview-subtotal {
      flex: 0 0 25%;
      text-align: right;
      font-weight: 600;
    }
    .preview-drawer.collapsed .preview-content {
      display: none;
    }
  </style>
</head>
<body>
  <h1>è‡ªåŠ©é»é¤</h1>
  <div class="subtitle">é¸å¥½é¤é»å¾ŒæŒ‰ä¸‹æ–¹ã€Œç¢ºèªã€ï¼Œå†å°‡ç•«é¢å‡ºç¤ºçµ¦æ«ƒæª¯</div>

  <!-- é»é¤ç•«é¢ -->
  <div id="order-view">
    <div class="section" id="menu"></div>
  </div>

  <!-- åº•éƒ¨ä¸Šæ–¹ã€Œå·²é¸å“é …ã€æŠ½å±œï¼ˆå¯å±•é–‹/æ”¶åˆï¼‰ -->
  <div id="preview-drawer" class="preview-drawer collapsed" style="display:none;">
    <div class="preview-drawer-inner">
      <button id="preview-toggle" class="preview-toggle">
        <span class="preview-handle" id="preview-toggle-arrow">â–²</span>
        <span id="preview-toggle-text" class="preview-toggle-text">å·²é¸å“é …ï¼ˆ0ï¼‰</span>
      </button>
      <div id="preview-content" class="preview-content">
        <div class="preview-title">å·²é¸å“é …</div>
        <div class="preview-list" id="preview-list"></div>
      </div>
    </div>
  </div>

  <!-- åº•éƒ¨å›ºå®šçš„ç¸½é‡‘é¡èˆ‡ç¢ºèªæŒ‰éˆ• -->
  <div class="footer">
    <div class="footer-inner">
      <div class="total">
        <span>ç¸½é‡‘é¡</span>
        <span id="total-amount">$0</span>
      </div>
      <button id="confirm-btn" class="btn-primary" disabled>ç¢ºèªä¸¦é¡¯ç¤ºçµ¦æ«ƒæª¯</button>
      <div class="hint">â€» åƒ¹æ ¼ä»¥ç¾å ´å…¬å‘Šç‚ºæº–ï¼Œå¦‚æœ‰å·®ç•°ä»¥åº—å…§ç‚ºä¸»</div>
    </div>
  </div>

  <!-- ç¢ºèªç•«é¢ï¼ˆçµ¦æ«ƒæª¯çœ‹çš„ï¼‰ -->
  <div id="confirm-view">
    <div class="order-title">è¨‚å–®æ˜ç´°</div>
    <div class="order-subtitle">è«‹å°‡æ­¤ç•«é¢å‡ºç¤ºçµ¦æ«ƒæª¯äººå“¡</div>
    <div id="order-summary"></div>
    <div class="order-total" id="order-total"></div>
    <div class="order-note">â€» è‹¥éœ€ä¿®æ”¹é¤é»ï¼Œè«‹é»é¸ã€Œè¿”å›é‡æ–°é»é¤ã€</div>
    <div class="order-back">
      <button id="back-btn" class="btn-ghost">è¿”å›é‡æ–°é»é¤</button>
    </div>
  </div>

  <script>
    // =========================
    // 1. èœå–®è³‡æ–™ï¼ˆå·²åˆ†åˆ†é¡ï¼‰
    // =========================
    const menuData = [
      {
        category: "æ¼¢å ¡",
        items: [
          { id: "item_0",  name: "ç‰ç±³è›‹å ¡",           code: "ç‰å ¡",   price: 35 },
          { id: "item_1",  name: "è‚‰é¬†è›‹å ¡",           code: "ã„™ã„¨ã„¥å ¡", price: 35 },
          { id: "item_2",  name: "è±¬è‚‰è›‹å ¡",           code: "Då ¡",    price: 40 },
          { id: "item_3",  name: "çƒ¤è‚‰è›‹å ¡",           code: "ã„å ¡",   price: 50 },
          { id: "item_4",  name: "é¦™é›è›‹å ¡",           code: "é¦™Gå ¡",  price: 45 },
          { id: "item_5",  name: "ç‰›è‚‰è›‹å ¡",           code: "ç‰›å ¡",   price: 45 },
          { id: "item_6",  name: "ç¸½åŒ¯è›‹å ¡",           code: "Allå ¡",  price: 55 },
          { id: "item_7",  name: "æ—¥å¼é›æ’è›‹å ¡",       code: "æ—¥Gå ¡",  price: 55 },
          { id: "item_8",  name: "æ—¥å¼è±¬æ’è›‹å ¡",       code: "æ—¥Då ¡",  price: 55 },
          { id: "item_9",  name: "æ—¥å¼èŠ±ææ’è›‹å ¡",     code: "èŠ±æå ¡", price: 55 },
          { id: "item_10", name: "æ—¥å¼è¦æ’è›‹å ¡",       code: "è¦æ’å ¡", price: 55 },
          { id: "item_11", name: "ç¾å¼é›è…¿ï¼ˆè¾£ï¼‰è›‹å ¡", code: "è¾›è…¿å ¡", price: 60 },
          { id: "item_12", name: "ç¾å¼é›è…¿ï¼ˆåŸï¼‰è›‹å ¡", code: "å…ƒè…¿å ¡", price: 60 }
        ]
      },
      {
        category: "æ¿ç‡’åå¸",
        items: [
          { id: "item_13", name: "ç…è›‹åå¸",           code: "è›‹åœŸ",   price: 30 },
          { id: "item_14", name: "ç‰ç±³è›‹åå¸",         code: "ç‰åœŸ",   price: 35 },
          { id: "item_15", name: "è‚‰é¬†è›‹åå¸",         code: "ã„™ã„¨ã„¥åœŸ", price: 35 },
          { id: "item_16", name: "çƒ¤è‚‰è›‹åå¸",         code: "ã„åœŸ",   price: 50 },
          { id: "item_17", name: "é¦™é›è›‹åå¸",         code: "é¦™GåœŸ",  price: 40 },
          { id: "item_18", name: "èµ·å¸è›‹åå¸",         code: "7åœŸ",    price: 35 },
          { id: "item_19", name: "ç¸½åŒ¯è›‹åå¸",         code: "AllåœŸ",  price: 55 },
          { id: "item_20", name: "ç«è…¿è›‹åå¸",         code: "ç«åœŸ",   price: 40 },
          { id: "item_21", name: "åŸ¹æ ¹è›‹åå¸",         code: "åŸ¹åœŸ",   price: 40 },
          { id: "item_22", name: "é®ªé­šè›‹åå¸",         code: "ğŸŸåœŸ",    price: 45 },
          { id: "item_23", name: "ç¾å¼é›è…¿ï¼ˆè¾£ï¼‰è›‹åå¸", code: "è¾›è…¿åœŸ", price: 60 },
          { id: "item_24", name: "ç¾å¼é›è…¿ï¼ˆåŸï¼‰è›‹åå¸", code: "å…ƒè…¿åœŸ", price: 60 }
        ]
      },
      {
        category: "ç¾å‘³è›‹é¤…",
        items: [
          { id: "item_25", name: "åŸå‘³è›‹é¤…", code: "å…ƒP",   price: 25 },
          { id: "item_26", name: "è‚‰é¬†è›‹é¤…", code: "ã„™ã„¨ã„¥P", price: 35 },
          { id: "item_27", name: "ç‰ç±³è›‹é¤…", code: "ç‰P",   price: 35 },
          { id: "item_28", name: "èµ·å¸è›‹é¤…", code: "7P",    price: 35 },
          { id: "item_29", name: "è”¬é£Ÿè›‹é¤…", code: "æ‰P",   price: 35 },
          { id: "item_30", name: "æ´‹è”¥è›‹é¤…", code: "æ´‹P",   price: 35 },
          { id: "item_31", name: "ç«è…¿è›‹é¤…", code: "ç«P",   price: 40 },
          { id: "item_32", name: "åŸ¹æ ¹è›‹é¤…", code: "åŸ¹P",   price: 40 },
          { id: "item_33", name: "ç†±ç‹—è›‹é¤…", code: "æ—ºP",   price: 40 },
          { id: "item_34", name: "é®ªé­šè›‹é¤…", code: "ğŸŸP",    price: 45 },
          { id: "item_35", name: "çƒ¤è‚‰è›‹é¤…", code: "ã„P",   price: 50 }
        ]
      },
      {
        category: "æ³•å¼éºµåŒ…",
        items: [
          { id: "item_36", name: "ç«è…¿èµ·å¸æ³•å¼éºµåŒ…",   code: "ç«æ³•åŒ…", price: 50 },
          { id: "item_37", name: "è•ƒèŒ„è±¬è‚‰æ³•å¼éºµåŒ…",   code: "ç•ªDæ³•åŒ…", price: 50 },
          { id: "item_38", name: "è‹œè“¿èŠ½èµ·å¸æ³•å¼éºµåŒ…", code: "è‹œæ³•åŒ…",  price: 50 },
          { id: "item_39", name: "é™½å…‰é¦™é›æ³•å¼éºµåŒ…",   code: "é¦™Gæ³•åŒ…", price: 50 },
          { id: "item_40", name: "è”¬é£Ÿçƒ¤è‚‰æ³•å¼éºµåŒ…",   code: "ã„æ³•åŒ…",  price: 60 },
          { id: "item_41", name: "æ—¥å¼ç‡»é›æ³•å¼éºµåŒ…",   code: "ç‡»é›æ³•åŒ…", price: 65 }
        ]
      },
      {
        category: "èµ·é…¥å ¡",
        items: [
          { id: "item_42", name: "è‰è“èµ·é…¥å ¡",   code: "è‰èµ·é…¥", price: 35 },
          { id: "item_43", name: "æ´‹èŠ‹è”¬é£Ÿèµ·é…¥å ¡", code: "æ´‹èµ·é…¥", price: 40 },
          { id: "item_44", name: "è‹œè“¿èŠ½ç‰ç±³èµ·é…¥å ¡", code: "è‹œèµ·é…¥", price: 40 },
          { id: "item_45", name: "è•ƒèŒ„è”¬é£Ÿèµ·é…¥å ¡", code: "ç•ªèµ·é…¥", price: 40 },
          { id: "item_46", name: "è”¬é£Ÿçƒ¤è‚‰èµ·é…¥å ¡", code: "çƒ¤èµ·é…¥", price: 55 }
        ]
      },
      {
        category: "å–®é»ç³»åˆ—",
        items: [
          { id: "item_47", name: "è·åŒ…è›‹ï¼ˆåŠç†Ÿï¼‰",   code: "åŠ",       price: 15 },
          { id: "item_48", name: "è·åŒ…è›‹ï¼ˆå…¨ç†Ÿï¼‰",   code: "å…¨",       price: 15 },
          { id: "item_49", name: "ç†±ç‹—ï¼ˆå››æ¢ï¼‰",     code: "HG",      price: 30 },
          { id: "item_50", name: "ç‰ç±³æ¿ƒæ¹¯ï¼ˆå°ï¼‰",   code: "æ¹¯",       price: 30 },
          { id: "item_51", name: "ç‰ç±³æ¿ƒæ¹¯ï¼ˆå¤§ï¼‰",   code: "å¤§æ¹¯",      price: 40 },
          { id: "item_52", name: "è–¯é¤…ï¼ˆå››ç‰‡ï¼‰",     code: "ã„•ã„¨Ë‡",    price: 40 },
          { id: "item_53", name: "é‹è²¼",           code: "è²¼",       price: 35 },
          { id: "item_54", name: "ç‚’éºµ",           code: "ã„”",       price: 35 },
          { id: "item_55", name: "é›å¡Š",           code: "GK",      price: 35 },
          { id: "item_56", name: "è˜¿è””ç³•",         code: "é«˜",       price: 35 },
          { id: "item_57", name: "èƒ¡éº»éµæ¿éºµ",     code: "éµï¼ˆèƒ¡éº»ï¼‰", price: 40 },
          { id: "item_58", name: "ç¾©éŸ¿éµæ¿éºµ",     code: "éµï¼ˆç™½é†¬ï¼‰", price: 50 },
          { id: "item_59", name: "è„†è–¯",           code: "è„†è–¯",      price: 40 },
          { id: "item_60", name: "ç¾å¼æ¹¯éºµ",       code: "ç¾æ¹¯",      price: 45 },
          { id: "item_61", name: "çƒ¤è‚‰ç‚’éºµ",       code: "ã„ã„”",      price: 55 }
        ]
      },
      {
        category: "æ—¥å¼ç©€å ¡",
        items: [
          { id: "item_62", name: "æ—¥å¼è”¬é£Ÿæ²™æ‹‰ç©€å ¡", code: "æ²™æ‹‰å¤", price: 40 },
          { id: "item_63", name: "æ—¥å¼å’–å–±ç©€å ¡",     code: "å’–å–±å¤", price: 40 },
          { id: "item_64", name: "å†°å·é­šæ’ç©€å ¡",     code: "é±ˆé­šå¤", price: 55 },
          { id: "item_65", name: "å­œç„¶é†¬é›æ’ç©€å ¡",   code: "å’–Gå¤",  price: 55 },
          { id: "item_66", name: "å­œç„¶é†¬è±¬æ’ç©€å ¡",   code: "å’–Då¤",  price: 55 }
        ]
      },
      {
        category: "è”¬é£Ÿæ²é¤…",
        items: [
          { id: "item_67", name: "é¦™é›è•ƒèŒ„æ²é¤…",   code: "é¦™Gå·", price: 45 },
          { id: "item_68", name: "é»ƒé‡‘çƒ¤è‚‰æ²é¤…",   code: "ã„å·",  price: 55 },
          { id: "item_69", name: "æ—¥å¼é›æ’æ²é¤…",   code: "æ—¥Gå·", price: 60 },
          { id: "item_70", name: "æµ·å‘³èŠ±ææ²é¤…",   code: "èŠ±æå·", price: 60 },
          { id: "item_71", name: "é®®å‘³è¦æ’æ²é¤…",   code: "è¦æ’å·", price: 60 },
          { id: "item_72", name: "åŸå‘³ç¾å¼é›è…¿æ²é¤…", code: "å…ƒè…¿å·", price: 60 },
          { id: "item_73", name: "è¾£å‘³ç¾å¼é›è…¿æ²é¤…", code: "è¾›è…¿å·", price: 60 }
        ]
      },
      {
        category: "ç”°åœ’è”¬æœ",
        items: [
          { id: "item_74", name: "é¦¬éˆ´è–¯åå¸",   code: "é¦¬åœŸ",  price: 40 },
          { id: "item_75", name: "å…¨éº¥è”¬é£Ÿé®ªé­š", code: "å…¨ğŸŸ",  price: 45 },
          { id: "item_76", name: "å…¨éº¥è‹œè“¿èŠ½ç«è…¿", code: "å…¨è‹œç«", price: 45 },
          { id: "item_77", name: "å…¨éº¥è”¬èœæ²™æ‹‰", code: "å…¨æ²™æ‹‰", price: 45 },
          { id: "item_78", name: "ç”°åœ’è”¬èœå·",   code: "æ‰å·",  price: 45 }
        ]
      },
      {
        category: "åšç‰‡",
        items: [
          { id: "item_79", name: "èµ·å¸å¥¶æ²¹åšç‰‡", code: "7å¥¶åš",  price: 35 },
          { id: "item_80", name: "é®ªé­šæ´‹è”¥åšç‰‡", code: "ğŸŸæ´‹åš", price: 45 },
          { id: "item_81", name: "ç‡»é›èµ·å¸åšç‰‡", code: "ç‡»é›åš", price: 50 }
        ]
      },
      {
        category: "æœé†¬ç³»åˆ—",
        items: [
          { id: "item_82", name: "æœé†¬åšç‰‡",   code: "æœé†¬åšç‰‡", price: 30 },
          { id: "item_87", name: "æœé†¬åå¸",   code: "æœé†¬åå¸", price: 25 },
          { id: "item_88", name: "æœé†¬èµ·é…¥å ¡", code: "æœé†¬èµ·é…¥", price: 35 }
        ]
      },
      {
        category: "æ³•åœ‹åå¸",
        items: [
          { id: "item_83", name: "æ—¥å¼åŸ¹æ ¹æ³•åœ‹åå¸", code: "åŸ¹æ³•åœŸ", price: 40 },
          { id: "item_84", name: "æ·±æµ·é®ªé­šæ³•åœ‹åå¸", code: "ğŸŸæ³•åœŸ",  price: 45 },
          { id: "item_85", name: "é»ƒé‡‘çƒ¤è‚‰æ³•åœ‹åå¸", code: "ã„æ³•åœŸ", price: 50 },
          { id: "item_86", name: "æœé†¬æ³•åœ‹åå¸",   code: "æœé†¬æ³•åœŸ", price: 30 }
        ]
      },
      {
        category: "å¤æ—©å‘³è±†æ¼¿",
        items: [
          { id: "item_89", name: "è±†æ¼¿ï¼ˆä¸­ï¼‰",     code: "D",   price: 25 },
          { id: "item_90", name: "è±†æ¼¿ï¼ˆå¤§ï¼‰",     code: "å¤§D",  price: 30 },
          { id: "item_93", name: "ç´…èŒ¶è±†æ¼¿ï¼ˆä¸­ï¼‰", code: "RD",  price: 25 },
          { id: "item_94", name: "ç´…èŒ¶è±†æ¼¿ï¼ˆå¤§ï¼‰", code: "å¤§RD", price: 30 },
          { id: "item_95", name: "è–ä»æ¼¿ï¼ˆä¸­ï¼‰",   code: "E",   price: 35 },
          { id: "item_96", name: "è–ä»æ¼¿ï¼ˆå¤§ï¼‰",   code: "å¤§E",  price: 40 }
        ]
      },
      {
        category: "ç´”å‘³èŒ¶",
        items: [
          { id: "item_91", name: "ç´…èŒ¶ï¼ˆä¸­ï¼‰", code: "R",  price: 25 },
          { id: "item_92", name: "ç´…èŒ¶ï¼ˆå¤§ï¼‰", code: "å¤§R", price: 30 },
          { id: "item_97", name: "ç¶ èŒ¶ï¼ˆä¸­ï¼‰", code: "G",  price: 25 },
          { id: "item_98", name: "ç¶ èŒ¶ï¼ˆå¤§ï¼‰", code: "å¤§G", price: 30 },
          { id: "item_99", name: "é’èŒ¶ï¼ˆä¸­ï¼‰", code: "7",  price: 25 },
          { id: "item_100", name: "é’èŒ¶ï¼ˆå¤§ï¼‰", code: "å¤§7", price: 30 }
        ]
      },
      {
        category: "é®®æ³¡èŒ¶",
        items: [
          { id: "item_101", name: "æ±æ–¹ç¾äºº", code: "æ±æ–¹", price: 40 },
          { id: "item_102", name: "é»ƒé‡‘çƒé¾", code: "çƒé¾", price: 40 },
          { id: "item_103", name: "é˜¿é‡Œå±±",   code: "é˜¿é‡Œ", price: 40 },
          { id: "item_104", name: "ç„ç±³ç‰éœ²", code: "ç„ç±³", price: 40 },
          { id: "item_105", name: "å››å­£ç¶ èŒ¶", code: "å››å­£", price: 40 }
        ]
      },
      {
        category: "å¥¶èŒ¶",
        items: [
          { id: "item_106", name: "å¥¶èŒ¶ï¼ˆä¸­ï¼‰", code: "M",   price: 30 },
          { id: "item_107", name: "å¥¶èŒ¶ï¼ˆå¤§ï¼‰", code: "å¤§M",  price: 35 },
          { id: "item_108", name: "å¥¶ç¶ ï¼ˆä¸­ï¼‰", code: "MG",  price: 30 },
          { id: "item_109", name: "å¥¶ç¶ ï¼ˆå¤§ï¼‰", code: "å¤§MG", price: 35 },
          { id: "item_110", name: "é’å¥¶ï¼ˆä¸­ï¼‰", code: "7M",  price: 30 },
          { id: "item_111", name: "é’å¥¶ï¼ˆå¤§ï¼‰", code: "å¤§7M", price: 35 }
        ]
      },
      {
        category: "æœ‰æ–™ç³»åˆ—",
        items: [
          { id: "item_112", name: "èƒšèŠ½å¥¶èŒ¶ï¼ˆä¸­ï¼‰", code: "ã„†D",    price: 30 },
          { id: "item_113", name: "èƒšèŠ½å¥¶èŒ¶ï¼ˆå¤§ï¼‰", code: "å¤§ã„†D",   price: 35 },
          { id: "item_114", name: "èŒ¶ç é’å¥¶ï¼ˆå¤§ï¼‰", code: "å¤§ O 7M", price: 50 },
          { id: "item_115", name: "èŒ¶ç é’å¥¶ï¼ˆä¸­ï¼‰", code: "O7M",    price: 40 },
          { id: "item_116", name: "èŒ¶ç ç¶ å¥¶ï¼ˆå¤§ï¼‰", code: "å¤§ O MG", price: 50 },
          { id: "item_117", name: "èŒ¶ç ç¶ å¥¶ï¼ˆä¸­ï¼‰", code: "O MG",   price: 40 }
        ]
      }
    ];

    // =========================
    // 2. ç•«é¢èˆ‡äº’å‹•é‚è¼¯
    // =========================

    const menuEl = document.getElementById("menu");
    const totalEl = document.getElementById("total-amount");
    const confirmBtn = document.getElementById("confirm-btn");

    const orderView = document.getElementById("order-view");
    const confirmView = document.getElementById("confirm-view");
    const orderSummaryEl = document.getElementById("order-summary");
    const orderTotalEl = document.getElementById("order-total");
    const backBtn = document.getElementById("back-btn");

    const previewDrawer = document.getElementById("preview-drawer");
    const previewToggle = document.getElementById("preview-toggle");
    const previewToggleText = document.getElementById("preview-toggle-text");
    const previewToggleArrow = document.getElementById("preview-toggle-arrow");
    const previewList = document.getElementById("preview-list");

    // æ¯å€‹å“é …çš„æ•¸é‡
    const qtyMap = {};
    menuData.forEach(cat => {
      cat.items.forEach(item => {
        qtyMap[item.id] = 0;
      });
    });

    function renderMenu() {
      menuEl.innerHTML = "";

      menuData.forEach(cat => {
        if (!cat.items || cat.items.length === 0) return;

        const details = document.createElement("details");
        const summary = document.createElement("summary");
        const label = document.createElement("div");
        label.className = "summary-label";
        label.innerHTML = `<span>${cat.category}</span>`;
        const icon = document.createElement("span");
        icon.className = "summary-icon";
        icon.textContent = "â–¾";
        summary.appendChild(label);
        summary.appendChild(icon);
        details.appendChild(summary);

        const catWrapper = document.createElement("div");
        catWrapper.className = "cat-content";

        cat.items.forEach(item => {
          const wrapper = document.createElement("div");
          wrapper.className = "item";

          const info = document.createElement("div");
          info.className = "item-info";
          info.innerHTML = `
            <div class="item-name">${item.name}</div>
            <div class="item-meta">$${item.price}</div>
          `;

          const control = document.createElement("div");
          control.className = "qty-control";

          const minusBtn = document.createElement("button");
          minusBtn.className = "btn-qty";
          minusBtn.textContent = "âˆ’";

          const qtySpan = document.createElement("span");
          qtySpan.className = "qty";
          qtySpan.textContent = "0";

          const plusBtn = document.createElement("button");
          plusBtn.className = "btn-qty";
          plusBtn.textContent = "+";

          minusBtn.addEventListener("click", () => {
            if (qtyMap[item.id] > 0) {
              qtyMap[item.id]--;
              qtySpan.textContent = qtyMap[item.id];
              updateTotalAndPreview();
            }
          });

          plusBtn.addEventListener("click", () => {
            qtyMap[item.id]++;
            qtySpan.textContent = qtyMap[item.id];
            updateTotalAndPreview();
          });

          control.appendChild(minusBtn);
          control.appendChild(qtySpan);
          control.appendChild(plusBtn);

          wrapper.appendChild(info);
          wrapper.appendChild(control);
          catWrapper.appendChild(wrapper);
        });

        details.appendChild(catWrapper);
        menuEl.appendChild(details);
      });
    }

    function updateTotalAndPreview() {
      let total = 0;
      let hasItem = false;
      let itemCount = 0;

      previewList.innerHTML = "";

      menuData.forEach(cat => {
        cat.items.forEach(item => {
          const qty = qtyMap[item.id];
          if (qty > 0) {
            hasItem = true;
            itemCount += qty;
            const lineAmount = qty * item.price;
            total += lineAmount;

            const row = document.createElement("div");
            row.className = "preview-row";

            const nameEl = document.createElement("div");
            nameEl.className = "preview-name";
            nameEl.textContent = item.name;

            const qtyEl = document.createElement("div");
            qtyEl.className = "preview-qty";
            qtyEl.textContent = "x" + qty;

            const subEl = document.createElement("div");
            subEl.className = "preview-subtotal";
            subEl.textContent = "$" + lineAmount;

            row.appendChild(nameEl);
            row.appendChild(qtyEl);
            row.appendChild(subEl);

            previewList.appendChild(row);
          }
        });
      });

      totalEl.textContent = "$" + total;
      confirmBtn.disabled = !hasItem;

      if (hasItem) {
        previewDrawer.style.display = "block";
        previewToggleText.textContent = `å·²é¸å“é …ï¼ˆ${itemCount}ï¼‰`;
      } else {
        previewDrawer.style.display = "none";
        previewToggleText.textContent = "å·²é¸å“é …ï¼ˆ0ï¼‰";
        if (!previewDrawer.classList.contains("collapsed")) {
          previewDrawer.classList.add("collapsed");
          previewToggleArrow.textContent = "â–²";
        }
      }
    }

    previewToggle.addEventListener("click", () => {
      const isCollapsed = previewDrawer.classList.toggle("collapsed");
      // æ”¶åˆç‹€æ…‹ï¼šé¡¯ç¤ºå‘ä¸Šä¸‰è§’ â–²ï¼ˆè¡¨ç¤ºå¯ä»¥ä¸Šæ‹‰å±•é–‹ï¼‰
      // å±•é–‹ç‹€æ…‹ï¼šé¡¯ç¤ºå‘ä¸‹ä¸‰è§’ â–¼ï¼ˆè¡¨ç¤ºå¯ä»¥æ”¶èµ·ï¼‰
      previewToggleArrow.textContent = isCollapsed ? "â–²" : "â–¼";
    });

    confirmBtn.addEventListener("click", () => {
      orderSummaryEl.innerHTML = "";
      let total = 0;

      menuData.forEach(cat => {
        cat.items.forEach(item => {
          const qty = qtyMap[item.id];
          if (qty > 0) {
            const lineAmount = item.price * qty;
            total += lineAmount;

            const line = document.createElement("div");
            line.className = "order-item-row";

            const colName = document.createElement("div");
            colName.className = "col-name";
            colName.textContent = item.name;

            const colCodeQty = document.createElement("div");
            colCodeQty.className = "col-codeqty";
            colCodeQty.textContent = item.code + "x" + qty;

            const colPrice = document.createElement("div");
            colPrice.className = "col-price";
            colPrice.textContent = "$" + lineAmount;

            line.appendChild(colName);
            line.appendChild(colCodeQty);
            line.appendChild(colPrice);

            orderSummaryEl.appendChild(line);
          }
        });
      });

      orderTotalEl.textContent = "ç¸½è¨ˆï¼š$" + total;

      orderView.style.display = "none";
      confirmView.style.display = "block";
      window.scrollTo(0, 0);
    });

    backBtn.addEventListener("click", () => {
      confirmView.style.display = "none";
      orderView.style.display = "block";
      window.scrollTo(0, 0);
    });

    renderMenu();
    updateTotalAndPreview();
  </script>
</body>
</html>
